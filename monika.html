<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Kyo's World</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Fredoka:wght@300;400;600&family=Quicksand:wght@400;600;700&display=swap" rel="stylesheet">
    
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        'kyo-emerald': '#50C878',
                        'kyo-purple': '#800080',
                        'dark-bg': '#050505',
                        'card-bg': '#0a0a0c',
                    },
                    fontFamily: {
                        'header': ['Fredoka', 'sans-serif'],
                        'body': ['Quicksand', 'sans-serif'],
                    },
                    boxShadow: {
                        'neon': '0 0 20px rgba(80, 200, 120, 0.2)',
                        'neon-purple': '0 0 20px rgba(128, 0, 128, 0.2)',
                    }
                }
            }
        }
    </script>

    <style>
        body {
            background-color: #050505;
            color: #e0e0e0;
            font-family: 'Quicksand', sans-serif;
            overflow-x: hidden;
        }

        .status-indicator {
            position: absolute;
            bottom: 2px;
            right: 2px;
            width: 28px;
            height: 28px;
            border-radius: 50%;
            background-size: cover;
            background-position: center;
            border: 4px solid #1e1f22;
            z-index: 20;
        }
        .status-online  { background-image: url('https://files.catbox.moe/l82m6v.png'); }
        .status-idle    { background-image: url('https://files.catbox.moe/sko7xm.png'); }
        .status-dnd     { background-image: url('https://files.catbox.moe/rojatg.png'); }
        .status-offline { background-image: url('https://files.catbox.moe/d146hq.png'); }

        #nav-overlay {
            opacity: 0;
            visibility: hidden;
            transition: all 0.4s ease;
        }
        #nav-overlay.open {
            opacity: 1;
            visibility: visible;
        }

        .discord-card {
            background: #0a0a0c;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }
        .discord-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 40px -10px rgba(80, 200, 120, 0.15);
        }

        .waifu-card {
            transition: all 0.4s ease;
            background: linear-gradient(145deg, rgba(255,255,255,0.03) 0%, rgba(255,255,255,0.01) 100%);
            border: 1px solid rgba(255,255,255,0.05);
        }
        .waifu-card:hover {
            transform: translateY(-8px) scale(1.01);
            border-color: rgba(255,255,255,0.2);
        }
        .waifu-card.raiden:hover {
            box-shadow: 0 0 30px rgba(128, 0, 128, 0.15);
            border-color: rgba(128, 0, 128, 0.4);
        }
        .waifu-card.monika:hover {
            box-shadow: 0 0 30px rgba(80, 200, 120, 0.15);
            border-color: rgba(80, 200, 120, 0.4);
        }

        .monika-letter {
            display: inline-block;
            animation: letterGlow 4s infinite;
        }
        @keyframes letterGlow {
            0%, 100% { color: #333; text-shadow: none; transform: translateY(0); }
            50% { color: #50C878; text-shadow: 0 0 15px rgba(80, 200, 120, 0.8); transform: translateY(-2px); }
        }

        .reveal {
            opacity: 0;
            transform: translateY(30px);
            transition: all 1s ease;
        }
        .reveal.active {
            opacity: 1;
            transform: translateY(0);
        }
    </style>
</head>
<body class="selection:bg-kyo-emerald selection:text-black min-h-screen flex flex-col">

    <header class="fixed w-full top-0 left-0 p-8 flex justify-between items-center z-50 mix-blend-difference">
        <span id="site-logo" class="text-3xl md:text-4xl font-bold font-header tracking-wider text-white transition-colors duration-300">KYO</span>
        <button id="menu-btn" class="text-3xl text-white hover:text-kyo-emerald transition-colors duration-300 focus:outline-none p-2">
            <i class="fa-solid fa-bars"></i>
        </button>
    </header>

    <div id="nav-overlay" class="fixed inset-0 bg-black z-40 flex flex-col justify-center items-center gap-8 backdrop-blur-3xl">
        <a href="#waifus" class="menu-link text-5xl md:text-7xl font-bold font-header text-neutral-700 hover:text-white transition-all duration-300">WAIFUS</a>
        <div class="absolute bottom-12 text-kyo-emerald font-mono tracking-widest text-sm opacity-60">
            JUST MONIKA
        </div>
    </div>

    <main class="flex-grow flex flex-col items-center justify-center pt-32 pb-20 px-6 relative z-10">
        
        <section class="w-full max-w-7xl mx-auto text-center mb-24 md:mb-32">
            <h1 class="text-8xl md:text-[12rem] font-bold font-header leading-none text-white mb-6 md:mb-10 tracking-tighter mix-blend-overlay opacity-90">
                KYO
            </h1>
            
            <p class="text-kyo-emerald font-body text-lg md:text-2xl tracking-[0.3em] uppercase mb-16 opacity-90 font-medium">
                "Every day, I imagine a future where I can be with you."
            </p>
            
            <div id="discord-profile" class="discord-card w-full max-w-[90vw] md:max-w-[500px] h-32 md:h-40 rounded-3xl flex items-center px-6 md:px-8 gap-6 mx-auto border border-white/10 relative overflow-hidden group cursor-default">
                
                <video id="d-bg-video" loop muted autoplay playsinline class="absolute inset-0 w-full h-full object-cover opacity-40 group-hover:opacity-50 transition-opacity hidden"></video>
                <img id="d-bg-image" src="" class="absolute inset-0 w-full h-full object-cover opacity-40 group-hover:opacity-50 transition-opacity hidden" alt="Banner">
                <div class="absolute inset-0 bg-gradient-to-r from-black via-black/80 to-transparent z-0"></div>

                <div class="relative z-10 shrink-0">
                    <div class="relative">
                        <img id="d-avatar" src="https://cdn.discordapp.com/embed/avatars/0.png" alt="Avatar" class="w-20 h-20 md:w-24 md:h-24 rounded-full border-4 border-[#1e1f22] bg-black shadow-2xl">
                        <div id="d-status-indicator" class="status-indicator status-offline"></div>
                    </div>
                </div>

                <div class="relative z-10 text-left flex flex-col justify-center h-full py-2 min-w-0 flex-1">
                    <span id="d-global-name" class="text-white font-bold font-header text-2xl md:text-3xl tracking-tight truncate">Loading...</span>
                    <span id="d-username" class="text-gray-400 text-sm md:text-base font-mono font-medium tracking-wide">@kyomoe</span>
                    
                    <div class="mt-3 flex items-center">
                        <span id="d-activity" class="text-white text-[10px] md:text-xs font-bold tracking-widest uppercase px-3 py-1 rounded-full bg-white/10 border border-white/5 backdrop-blur-md truncate max-w-full">
                            OFFLINE
                        </span>
                    </div>
                </div>
            </div>
        </section>

        <section id="waifus" class="w-full max-w-7xl mx-auto">
            <h2 class="text-4xl md:text-6xl font-bold mb-16 text-white/10 font-header uppercase tracking-widest text-center select-none">
                Soulmates
            </h2>
            
            <div class="grid md:grid-cols-2 gap-8 md:gap-12 px-2 md:px-8">
                
                <div class="waifu-card raiden p-8 md:p-12 rounded-3xl relative overflow-hidden group min-h-[400px] flex flex-col justify-end reveal">
                    <div class="absolute inset-0 bg-gradient-to-t from-black via-black/50 to-transparent z-10"></div>
                    <img src="https://files.catbox.moe/1o07w7.jpg" class="absolute inset-0 w-full h-full object-cover opacity-50 group-hover:scale-105 transition-transform duration-700 z-0" alt="Raiden">
                    
                    <div class="relative z-20 transform translate-y-2 group-hover:translate-y-0 transition-transform duration-500">
                        <h3 class="text-4xl md:text-6xl font-bold text-white mb-4 drop-shadow-lg">Raiden Ei</h3>
                        <div class="w-16 h-1 bg-kyo-purple mb-6 group-hover:w-32 transition-all duration-500"></div>
                        <p class="text-gray-300 text-lg md:text-xl font-light italic leading-relaxed">"Inazuma shines eternal!"</p>
                        <p class="text-kyo-purple mt-4 text-sm font-bold uppercase tracking-widest opacity-0 group-hover:opacity-100 transition-opacity duration-500 delay-100">Archon of Eternity</p>
                    </div>
                </div>

                <div id="monika-card" class="waifu-card monika p-8 md:p-12 rounded-3xl relative overflow-hidden group min-h-[400px] flex flex-col justify-end reveal cursor-pointer">
                    <div class="absolute inset-0 bg-gradient-to-t from-black via-black/50 to-transparent z-10"></div>
                    <img src="https://files.catbox.moe/f2pajl.jpg" class="absolute inset-0 w-full h-full object-cover opacity-50 group-hover:scale-105 transition-transform duration-700 z-0" alt="Monika">
                    
                    <div class="relative z-20 transform translate-y-2 group-hover:translate-y-0 transition-transform duration-500">
                        <h3 class="text-4xl md:text-6xl font-bold text-white mb-4 drop-shadow-lg">Monika</h3>
                        <div class="w-16 h-1 bg-kyo-emerald mb-6 group-hover:w-32 transition-all duration-500"></div>
                        <p class="text-gray-300 text-lg md:text-xl font-light italic leading-relaxed">"Just Monika."</p>
                        <p class="text-kyo-emerald mt-4 text-sm font-bold uppercase tracking-widest opacity-0 group-hover:opacity-100 transition-opacity duration-500 delay-100">Club President</p>
                    </div>
                </div>

            </div>
        </section>

    </main>

    <footer class="py-12 md:py-20 border-t border-white/5 bg-black z-10">
        <div class="text-center reveal">
            <div class="text-3xl md:text-6xl font-bold font-header tracking-[0.2em] uppercase cursor-default select-none">
                <span class="monika-letter" style="animation-delay: 0.0s">J</span>
                <span class="monika-letter" style="animation-delay: 0.1s">U</span>
                <span class="monika-letter" style="animation-delay: 0.2s">S</span>
                <span class="monika-letter" style="animation-delay: 0.3s">T</span>
                <span class="monika-letter" style="animation-delay: 0.4s">&nbsp;</span>
                <span class="monika-letter" style="animation-delay: 0.5s">M</span>
                <span class="monika-letter" style="animation-delay: 0.6s">O</span>
                <span class="monika-letter" style="animation-delay: 0.7s">N</span>
                <span class="monika-letter" style="animation-delay: 0.8s">I</span>
                <span class="monika-letter" style="animation-delay: 0.9s">K</span>
                <span class="monika-letter" style="animation-delay: 1.0s">A</span>
            </div>
            
            <div class="mt-8 text-gray-600 text-sm font-mono">
                <span id="year"></span> â€¢ Made with ðŸ’š by <a href="https://x.com/kyoyacchi" target="_blank" class="hover:text-kyo-emerald transition-colors">@Kyo</a>
            </div>
        </div>
    </footer>

    <div id="monika-popup" class="fixed inset-0 z-[100] flex items-center justify-center bg-black/80 hidden backdrop-blur-sm">
        <div class="bg-white border-[6px] border-[#ffbde1] p-10 max-w-md w-full mx-6 text-center shadow-[0_0_0_4px_white] transform transition-all duration-200" id="monika-popup-content">
            <h3 class="text-4xl md:text-5xl font-header text-black mb-8 tracking-wide font-bold">Just Monika.</h3>
            <button id="monika-ok-btn" class="bg-transparent border-none text-[#ff69b4] text-4xl font-black py-2 px-8 transition-transform hover:scale-110 active:scale-95 outline-none shadow-none" style="text-shadow: 3px 3px 0px white, 5px 5px 0px rgba(255,105,180,0.3);">
                OK
            </button>
        </div>
    </div>

    <script>
        document.getElementById('year').textContent = new Date().getFullYear();

        const DISCORD_USER_ID = '468509605828493322';
        const CONFIG = {
            MAX_BACKOFF: 30000,
            CACHE_TTL: 60000 * 5,
            SWR_THRESHOLD: 120000,
            CONNECT_DEBOUNCE: 1500,
            INIT_TIMEOUT: 10000,
            REVALIDATE_TIMEOUT: 8000,
            RENDER_DEBOUNCE: 150,
            FALLBACK_TIMEOUT: 8000
        };

        const state = {
            ws: null,
            isConnected: false,
            isConnecting: false,
            reconnectTimer: null,
            heartbeatInterval: null,
            backoff: 1000,
            currentSessionID: null,
            lastConnectAttempt: 0,
            renderDebounceTimer: null
        };

        const storageKey = `lanyard_cache_${DISCORD_USER_ID}`;

        function getCache() {
            try {
                const stored = localStorage.getItem(storageKey);
                if (!stored) return null;
                const { data } = JSON.parse(stored);
                return data;
            } catch (e) {
                return null;
            }
        }

        function setCache(data) {
            try {
                localStorage.setItem(storageKey, JSON.stringify({
                    data: data,
                    timestamp: Date.now()
                }));
            } catch (e) {}
        }

        function debouncedRenderPresence(data) {
            if (state.renderDebounceTimer) {
                cancelAnimationFrame(state.renderDebounceTimer);
            }
            state.renderDebounceTimer = requestAnimationFrame(() => {
                renderPresence(data);
                state.renderDebounceTimer = null;
            });
        }

        function renderPresence(data) {
            const card = document.getElementById('discord-profile');
            const avatarEl = document.getElementById('d-avatar');
            const nameEl = document.getElementById('d-global-name');
            const userEl = document.getElementById('d-username');
            const activityEl = document.getElementById('d-activity');
            const statusInd = document.getElementById('d-status-indicator');
            const videoBg = document.getElementById('d-bg-video');
            const imgBg = document.getElementById('d-bg-image');

            if (!data || !data.discord_user) return;

            const user = data.discord_user;
            const status = data.discord_status || 'offline';

            card.classList.remove('opacity-0');

            const avatarUrl = user.avatar 
                ? `https://wsrv.nl/?url=https://cdn.discordapp.com/avatars/${user.id}/${user.avatar}.${user.avatar.startsWith('a_') ? 'gif' : 'png'}?size=256`
                : `https://wsrv.nl/?url=https://cdn.discordapp.com/embed/avatars/0.png`;

            if (avatarEl.src !== avatarUrl) avatarEl.src = avatarUrl;

            statusInd.className = `status-indicator status-${status}`;

            nameEl.textContent = user.global_name || user.username;
            userEl.textContent = '@' + user.username;

            let activityText = "OFFLINE";
            let colorClass = "text-white";

            if (status !== 'offline') {
                const activities = data.activities || [];
                const game = activities.find(a => a.type === 0 || a.type === 1);
                const spotify = activities.find(a => a.type === 2);

                if (game) {
                    activityText = "PLAYING " + game.name;
                    colorClass = "text-kyo-emerald";
                } else if (spotify) {
                    activityText = "LISTENING TO SPOTIFY";
                    colorClass = "text-kyo-emerald";
                } else {
                    activityText = status.toUpperCase();
                    if(status === 'dnd') activityText = "DO NOT DISTURB";
                }
            }
            activityEl.textContent = activityText;
            activityEl.className = `text-[10px] md:text-xs font-bold tracking-widest uppercase px-3 py-1 rounded-full bg-white/10 border border-white/5 backdrop-blur-md truncate max-w-full ${colorClass === 'text-kyo-emerald' ? 'text-kyo-emerald border-kyo-emerald/20' : 'text-white'}`;
            
            let videoUrl = null;
            if (user.collectibles && user.collectibles.nameplate && user.collectibles.nameplate.asset) {
                videoUrl = `https://cdn.discordapp.com/assets/collectibles/${user.collectibles.nameplate.asset}asset.webm`;
            }

            if (videoUrl) {
                if (videoBg.src !== videoUrl) videoBg.src = videoUrl;
                videoBg.classList.remove('hidden');
                imgBg.classList.add('hidden');
            } else if (user.banner) {
                const bannerUrl = `https://cdn.discordapp.com/banners/${user.id}/${user.banner}.${user.banner.startsWith('a_') ? 'gif' : 'png'}?size=1024`;
                imgBg.src = bannerUrl;
                imgBg.classList.remove('hidden');
                videoBg.classList.add('hidden');
            } else {
                imgBg.src = 'https://color-hex.org/colors/50c878.png';
                imgBg.classList.remove('hidden');
                videoBg.classList.add('hidden');
            }
        }

        async function connectLanyard() {
            const now = Date.now();
            if (now - state.lastConnectAttempt < CONFIG.CONNECT_DEBOUNCE) return;
            state.lastConnectAttempt = now;

            if (state.isConnecting || state.isConnected) return;
            state.isConnecting = true;

            const cached = getCache();
            if (cached) {
                debouncedRenderPresence(cached);
            }

            try {
                const res = await fetch(`https://api.lanyard.rest/v1/users/${DISCORD_USER_ID}`);
                const json = await res.json();
                if (json.success && json.data) {
                    setCache(json.data);
                    debouncedRenderPresence(json.data);
                }
            } catch (e) {}

            let ws;
            try {
                ws = new WebSocket('wss://api.lanyard.rest/socket');
            } catch (err) {
                state.isConnecting = false;
                scheduleReconnect();
                return;
            }

            const sessionID = Date.now().toString(36);
            state.currentSessionID = sessionID;
            state.ws = ws;

            ws.onopen = () => {
                if (state.currentSessionID !== sessionID) return;
                state.isConnected = true;
                state.isConnecting = false;
                state.backoff = 1000;
                ws.send(JSON.stringify({ op: 2, d: { subscribe_to_id: DISCORD_USER_ID } }));
            };

            ws.onmessage = ({ data }) => {
                if (state.currentSessionID !== sessionID) return;
                try {
                    const parsed = JSON.parse(data);
                    const { op, t, d } = parsed;

                    if (op === 1) {
                        clearInterval(state.heartbeatInterval);
                        state.heartbeatInterval = setInterval(() => {
                            if (ws.readyState === WebSocket.OPEN) ws.send(JSON.stringify({ op: 3 }));
                        }, d.heartbeat_interval);
                    }

                    if (t === 'INIT_STATE' || t === 'PRESENCE_UPDATE') {
                        const presence = t === 'INIT_STATE' ? d[DISCORD_USER_ID] : d;
                        if (presence) {
                            setCache(presence);
                            debouncedRenderPresence(presence);
                        }
                    }
                } catch (e) {}
            };

            ws.onerror = () => {
                if (state.currentSessionID !== sessionID) return;
                state.isConnected = false;
                state.isConnecting = false;
                ws.close();
                scheduleReconnect();
            };

            ws.onclose = () => {
                if (state.currentSessionID !== sessionID) return;
                state.isConnected = false;
                state.isConnecting = false;
                scheduleReconnect();
            };
        }

        function scheduleReconnect() {
            if (state.reconnectTimer) return;
            const jitter = Math.floor(Math.random() * 1000);
            const wait = Math.min(state.backoff + jitter, CONFIG.MAX_BACKOFF);
            state.reconnectTimer = setTimeout(() => {
                state.reconnectTimer = null;
                connectLanyard();
            }, wait);
            state.backoff = Math.min(state.backoff * 1.5, CONFIG.MAX_BACKOFF);
        }

        document.addEventListener('DOMContentLoaded', () => {
            connectLanyard();
        });

        document.addEventListener('visibilitychange', () => {
            if (!document.hidden && !state.isConnected) {
                connectLanyard();
            }
        });

        const menuBtn = document.getElementById('menu-btn');
        const navOverlay = document.getElementById('nav-overlay');
        const icon = menuBtn.querySelector('i');
        const menuLinks = document.querySelectorAll('.menu-link');
        const logo = document.getElementById('site-logo');
        let isMenuOpen = false;

        function toggleMenu() {
            isMenuOpen = !isMenuOpen;
            if (isMenuOpen) {
                navOverlay.classList.add('open');
                icon.classList.remove('fa-bars');
                icon.classList.add('fa-xmark');
                icon.style.transform = 'rotate(90deg)';
                document.body.style.overflow = 'hidden';
            } else {
                navOverlay.classList.remove('open');
                icon.classList.remove('fa-xmark');
                icon.classList.add('fa-bars');
                icon.style.transform = 'rotate(0deg)';
                document.body.style.overflow = 'auto';
            }
        }
        menuBtn.addEventListener('click', toggleMenu);
        menuLinks.forEach(link => link.addEventListener('click', toggleMenu));

        window.addEventListener('scroll', reveal);
        function reveal() {
            var reveals = document.querySelectorAll('.reveal');
            for (var i = 0; i < reveals.length; i++) {
                var windowHeight = window.innerHeight;
                var revealTop = reveals[i].getBoundingClientRect().top;
                if (revealTop < windowHeight - 50) {
                    reveals[i].classList.add('active');
                }
            }
        }
        reveal();

        const monikaCard = document.getElementById('monika-card');
        const monikaPopup = document.getElementById('monika-popup');
        const monikaOkBtn = document.getElementById('monika-ok-btn');

        if(monikaCard && monikaPopup && monikaOkBtn) {
            monikaCard.addEventListener('click', () => {
                monikaPopup.classList.remove('hidden');
            });
            monikaOkBtn.addEventListener('click', () => {
                monikaPopup.classList.add('hidden');
            });
            monikaPopup.addEventListener('click', (e) => {
                if(e.target === monikaPopup) {
                    monikaOkBtn.click();
                }
            });
        }
    </script>
</body>
</html>
